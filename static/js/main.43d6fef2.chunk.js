(this["webpackJsonpblog-app"]=this["webpackJsonpblog-app"]||[]).push([[0],{114:function(e,t,r){"use strict";r.r(t);var a=r(1),s=r.n(a),n=r(35),c=r.n(n),o=(r(47),r(20),r(11)),i=r(7),l=r(8),d=r(10),u=r(9),h=r(6),j=r(4),m="https://mighty-oasis-08080.herokuapp.com/api/",b=m+"articles",p=m+"user",x=m+"profiles/",g="app_user",f=r(0);function O(e){return Object(f.jsxs)("nav",{className:"flex items-center",children:[Object(f.jsx)(h.c,{to:{user:e.user,pathname:"/profiles/".concat(e.user.username)},className:"btn mr-5 bg-yellow-100 transform transition duration-500 hover:scale-105",children:Object(f.jsxs)("li",{className:"flex items-center text-xl mx-3",children:[Object(f.jsx)("img",{src:e.user.image||"smiley.png",alt:e.user.username,className:"w-5 h-5 rounded-full"}),Object(f.jsx)("span",{className:"ml-2 text-gray-600 font-thin",children:e.user.username})]})}),Object(f.jsx)(h.c,{to:"/articles",activeClassName:"btn-active",className:"btn btn-green mr-5",children:"Home"}),Object(f.jsx)(h.c,{to:"/new-article",activeClassName:"btn-active",className:"btn btn-green mr-5",children:"New Article"}),Object(f.jsx)("button",{className:"btn btn-green",onClick:e.handleLogout,children:"Logout"})]})}function v(e){return Object(f.jsxs)("nav",{className:"flex",children:[Object(f.jsx)(h.c,{to:"/articles",activeClassName:"btn-active",className:"btn btn-green mr-5",children:"Home"}),Object(f.jsx)(h.c,{to:"/register",activeClassName:"btn-active",className:"btn btn-green mr-5",children:"Sign-Up"}),Object(f.jsx)(h.c,{to:"/login",activeClassName:"btn-active",className:"btn btn-green",children:"Log-In"})]})}var y=Object(j.f)((function(e){return Object(f.jsxs)("header",{className:"flex justify-between bg-green-50 px-20 py-8",children:[Object(f.jsx)(h.c,{to:"/",children:Object(f.jsx)("h1",{className:"text-4xl font-extrabold text-gray-700 font-logo",children:"Alt Blog"})}),Object(f.jsx)("nav",{className:"flex",children:e.isLoggedIn?Object(f.jsx)(O,Object(o.a)(Object(o.a)({},e),{},{handleLogout:function(){localStorage.removeItem(g),e.handleLogout(),e.history.push("/articles")}})):Object(f.jsx)(v,{})})]})}));var N=function(){return Object(f.jsx)("main",{children:Object(f.jsxs)("div",{className:"text-center p-12 mt-12 bg-yellow-100",children:[Object(f.jsx)("h2",{className:"text-5xl font-bold mb-10",children:"Welcome to Alt Blog"}),Object(f.jsx)(h.b,{to:"/articles",children:Object(f.jsx)("button",{className:"btn btn-indigo",children:"View Articles"})})]})})},w=r(12);function S(e,t,r){switch(t){case"username":e.username=r?r.length<6?"username should be atleast 6 characters":"":"username is required";break;case"password":e.password=function(e){return e?e.length<6?"Password must be alteast 6 characters long":-1===e.search(/[a-zA-Z]/)?"Password must contain atleast one letter":-1===e.search(/\d/)?"Password must contain atleast one number":"":"Password is required"}(r);break;case"email":e.email=r?/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r)?"":"Email is invalid":"email is required"}}var C=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).handleChange=function(e){var t,r=e.target,s=r.name,n=r.value,c=a.state.errors;S(c,s,n),a.setState((t={},Object(w.a)(t,s,n),Object(w.a)(t,"errors",c),t))},a.handleSubmit=function(e){var t=a.state,r=t.email,s=t.password,n=t.username,c=t.errors;e.preventDefault(),n&&s&&r&&fetch("https://mighty-oasis-08080.herokuapp.com/api/users",{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({user:{username:n,password:s,email:r}})}).then((function(e){return e.ok?e.json():e.json().then((function(e){for(var t in e.errors)c[t]="".concat(t," ").concat(e.errors[t]);return Promise.reject(c)}))})).then((function(e){var t=e.user;console.log(t),a.props.updateUser(t),a.setState({password:"",email:"",username:"",errors:c}),a.props.history.push("/login")})).catch((function(e){return a.setState({errors:e})}))},a.state={username:"",email:"",password:"",errors:{username:"",password:"",email:""}},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this,t=this.state.errors,r=t.username,a=t.password,s=t.email;return Object(f.jsx)("main",{children:Object(f.jsx)("section",{className:"mt-20",children:Object(f.jsxs)("form",{className:"w-1/3 mx-auto border border-gray-400 p-6 rounded-md shadow-md",onSubmit:this.handleSubmit,children:[Object(f.jsxs)("div",{className:"text-center",children:[Object(f.jsx)("legend",{className:"text-2xl font-bold",children:"Sign Up"}),Object(f.jsx)(h.b,{to:"/login",children:Object(f.jsxs)("span",{className:"text-green-700 text-lg text-center",children:["Already Have an account?"," "]})})]}),Object(f.jsxs)("fieldset",{className:"my-3",children:[Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"text",placeholder:"Enter Username",value:this.state.username,name:"username",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("span",{className:"text-red-500",children:r}),Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"text",placeholder:"Enter Email",value:this.state.email,name:"email",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("span",{className:"text-red-500",children:s}),Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"password",placeholder:"Enter Password",value:this.state.password,name:"password",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("span",{className:"text-red-500",children:a}),Object(f.jsx)("input",{type:"submit",value:"Sign Up",className:"block w-full btn bg-green-500 text-white font-bold cursor-pointer",disabled:r||s||a})]})]})})})}}]),r}(s.a.Component),k=Object(j.f)(C),P=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).handleChange=function(e){var t,r=e.target,s=r.name,n=r.value,c=a.state.errors;S(c,s,n),a.setState((t={},Object(w.a)(t,s,n),Object(w.a)(t,"errors",c),t))},a.handleSubmit=function(e){var t=a.state,r=t.email,s=t.password;e.preventDefault(),s&&r&&fetch("https://mighty-oasis-08080.herokuapp.com/api/users/login",{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({user:{password:s,email:r}})}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(e){var t=e.user;console.log(t),a.props.updateUser(t),a.setState({password:"",email:""}),a.props.history.push("/articles")})).catch((function(e){a.setState((function(e){return Object(o.a)(Object(o.a)({},e),{},{errors:Object(o.a)(Object(o.a)({},e.errors),{},{email:"Email or Password is incorrect!"})})}))}))},a.state={email:"",password:"",errors:{email:"",password:""}},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this,t=this.state.errors,r=t.email,a=t.password;return Object(f.jsx)("main",{children:Object(f.jsx)("section",{className:"mt-20",children:Object(f.jsxs)("form",{className:"w-1/3 mx-auto border border-gray-400 p-6 rounded-md shadow-md",onSubmit:this.handleSubmit,children:[Object(f.jsxs)("div",{className:"text-center",children:[Object(f.jsx)("legend",{className:"text-2xl font-bold",children:"Sign In"}),Object(f.jsx)(h.b,{to:"/register",children:Object(f.jsxs)("span",{className:"text-green-700 text-lg text-center",children:[" ","New here?"," "]})})]}),Object(f.jsxs)("fieldset",{className:"my-3",children:[Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"text",placeholder:"Enter Email",value:this.state.email,name:"email",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("span",{className:"text-red-500",children:r}),Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"password",placeholder:"Enter Password",value:this.state.password,name:"password",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("span",{className:"text-red-500",children:a}),Object(f.jsx)("input",{type:"submit",value:"Log In",className:"block w-full my-6 py-2 px-3 btn btn-green cursor-pointer",disabled:a||r})]})]})})})}}]),r}(s.a.Component),A=Object(j.f)(P);var I=function(){return Object(f.jsx)("div",{className:"flex justify-center p-5",children:Object(f.jsxs)("div",{className:"lds-grid",children:[Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{})]})})},T=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).getDate=function(e){return new Date(e).toISOString().split("T")[0]},a.state={},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.articles,a=t.error;return a?Object(f.jsx)("h2",{className:"text-red-500 text-center text-xl mt-8",children:a}):r?r.length?Object(f.jsx)("article",{children:r.map((function(t){return Object(f.jsxs)("div",{className:"bg-green-200 flex justify-between flex-col my-3 w-full p-4 rounded-md",children:[Object(f.jsxs)("div",{className:"flex justify-between w-full",children:[Object(f.jsxs)("div",{className:"flex items-center my-2",children:[Object(f.jsx)(h.b,{to:"/profiles/".concat(t.author.username),children:Object(f.jsx)("img",{src:t.author.image||"smiley.png",alt:t.author.username,className:"w-14 h-14 rounded-full object-cover"})}),Object(f.jsxs)("div",{className:"ml-4",children:[Object(f.jsx)("h5",{className:"text-indigo-900 font-bold text-xl mr-5",children:t.author.username}),Object(f.jsx)("h6",{children:e.getDate(t.createdAt)})]})]}),Object(f.jsxs)("div",{className:"flex items-center text-xl border border-purple-900 px-2 py-3",children:[Object(f.jsx)("i",{className:e.props.isLoggedIn?t.favorited?"fas fa-heart cursor-pointer text-pink-600":"far fa-heart cursor-pointer":"fas fa-heart text-red-700",onClick:function(t){return e.props.handleFavorite(t)},"data-id":t.favorited,"data-slug":t.slug}),Object(f.jsx)("span",{className:"ml-2",children:t.favoritesCount})]})]}),Object(f.jsx)("h2",{className:"text-2xl font-bold mb-5 mt-5",children:t.title}),Object(f.jsx)("p",{className:"text-gray-500 mb-5",children:t.description}),Object(f.jsx)(h.b,{to:"/articles/".concat(t.slug),children:Object(f.jsx)("h4",{className:"btn btn-indigo inline-block",children:"Read More"})})]},t.slug)}))}):Object(f.jsx)("h2",{className:"text-red-500 text-center text-xl mt-8",children:"No articles found"}):Object(f.jsx)(I,{})}}]),r}(s.a.Component),E=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).state={allTags:null,error:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this;fetch("https://mighty-oasis-08080.herokuapp.com/api/tags").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(t){var r=t.tags;e.setState({allTags:r,error:""})})).catch((function(t){e.setState({error:"Not able to fetch Tags"})}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.error,a=t.allTags;return r?Object(f.jsx)("h2",{className:"text-red-500 text-center text-xl mt-8",children:r}):a?Object(f.jsx)("aside",{className:"flex flex-wrap bg-green-200 px-4 py-8 rounded-md",children:a.map((function(t){return Object(f.jsx)("span",{className:"bg-gray-800 p-2 cursor-pointer text-white text-xs rounded-md mx-1 my-1",onClick:function(t){return e.props.selectTag(t)},"data-value":t,children:t},t)}))}):Object(f.jsx)(I,{})}}]),r}(s.a.Component);var L=function(e){for(var t=e.articlesCount,r=e.articlesPerPage,a=e.activePageIndex,s=e.updateCurrentPageIndex,n=Math.ceil(t/r),c=[],o=1;o<=n;o++)c.push(o);return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"flex",children:[Object(f.jsx)("p",{className:"font-bold self-center cursor-pointer hover:shadow-lg",onClick:function(){return s(a-1<1?1:a-1)},children:"< Prev"}),c.map((function(e,t){return Object(f.jsx)("span",{className:a===e?"bg-green-600 text-white py-2 px-4 mx-4 cursor-pointer hover:bg-green-500":"border border-gray-400 bg-green-50 py-2 px-4 mx-4 cursor-pointer hover:bg-blue-400",onClick:function(){return s(e)},children:e},e)})),Object(f.jsx)("p",{className:"font-bold self-center cursor-pointer hover:shadow-lg",onClick:function(){return s(a+1>n?n:a+1)},children:"Next >"})]})})},D=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).updateCurrentPageIndex=function(e){a.setState({activePageIndex:e},a.getArticles)},a.getArticles=function(){var e=a.state.articlesPerPage,t=10*(a.state.activePageIndex-1),r=a.state.tagSelected,s=localStorage.app_user;fetch(b+"/?offset=".concat(t,"&limit=").concat(e)+(r&&"&tag=".concat(r)),{method:"GET",headers:{Authorization:"Bearer ".concat(s),"Content-type":"application/json"}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){console.log({data:e}),a.setState({articles:e.articles,articlesCount:e.articlesCount})})).catch((function(e){a.setState({error:"Not able to fetch Articles"})}))},a.selectTag=function(e){var t=e.target.dataset.value;a.setState({tagSelected:t},a.getArticles())},a.myFeed=function(){var e=10*(a.state.activePageIndex-1),t=localStorage.app_user;fetch("https://mighty-oasis-08080.herokuapp.com/api/articles/feed"+"?/limit=".concat(a.state.articlesPerPage,"&skip=").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t),"Content-type":"application/json"}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){a.setState({articles:e.articles,articlesCount:e.articlesCount,feedSelected:"myfeed",tagSelected:""})})).catch((function(e){return a.setState({error:"Not able to fetch Articles"})}))},a.handleFavorite=function(e){var t=e.target.dataset,r=t.id,s=t.slug,n="false"===r?"POST":"DELETE";console.log(n),console.log(r,s),a.props.isLoggedIn&&fetch(b+"/"+s+"/favorite",{method:n,headers:{Authorization:"Token "+localStorage.app_user}}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(e){"myfeed"===a.state.feedSelected?a.myFeed():a.getArticles()})).catch((function(e){return console.log(e)}))},a.state={articles:null,error:"",articlesCount:0,articlesPerPage:10,activePageIndex:1,tagSelected:"",feedSelected:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.props.isLoggedIn?this.setState({feedSelected:"myfeed"},this.myFeed):this.setState({feedSelected:"global"},this.getArticles)}},{key:"componentDidUpdate",value:function(e,t){t.activePageIndex===this.state.activePageIndex&&t.tagSelected===this.state.tagSelected||this.getArticles()}},{key:"render",value:function(){var e=this,t=this.state,r=t.articles,a=t.error,s=t.articlesCount,n=t.articlesPerPage,c=t.activePageIndex,o=t.feedSelected;return Object(f.jsxs)("main",{className:"px-24 py-16 w-full",children:[Object(f.jsxs)("div",{className:"flex mb-3",children:[Object(f.jsxs)("span",{className:"global"===o?"cursor-pointer mr-8 text-xl text-green-500":"cursor-pointer mr-8 text-xl",onClick:function(){return e.setState({tagSelected:"",feedSelected:"global"},e.getArticles)},children:[Object(f.jsx)("i",{className:"fas fa-newspaper mr-2"}),"Global Feed"]}),Object(f.jsxs)("span",{className:this.props.isLoggedIn?"myfeed"===o?"text-xl mr-8 cursor-pointer text-green-500":"text-xl  cursor-pointer green":"hidden",onClick:this.myFeed,children:[" ",Object(f.jsx)("i",{className:"fas fa-newspaper mr-2"}),"My feed"]}),Object(f.jsxs)("div",{className:this.state.tagSelected?"visible text-xl":"hidden",children:[Object(f.jsx)("span",{className:"mx-2 text-gray-500",children:"/"}),Object(f.jsxs)("span",{className:"text-green-700",children:["#",this.state.tagSelected]})]})]}),Object(f.jsxs)("section",{className:"flex justify-between ",children:[Object(f.jsx)("div",{className:"w-4/6",children:Object(f.jsx)(T,{articles:r,error:a,isLoggedIn:this.props.isLoggedIn,handleFavorite:this.handleFavorite})}),Object(f.jsx)("div",{className:"w-80",children:Object(f.jsx)(E,{selectTag:this.selectTag})})]}),Object(f.jsx)("div",{className:"mt-10",children:Object(f.jsx)(L,{articlesCount:s,articlesPerPage:n,activePageIndex:c,updateCurrentPageIndex:this.updateCurrentPageIndex})})]})}}]),r}(s.a.Component);var U=function(e){var t=e.comments,r=e.loggedInUser,a=e.isLoggedIn;return t?Object(f.jsx)(f.Fragment,{children:t.length>0?t.map((function(t){return Object(f.jsxs)("div",{className:"flex item-center p-6 bg-gray-100 mb-4 rounded-t-md relative",children:[Object(f.jsx)("div",{className:"",children:Object(f.jsx)("img",{src:t.author.image,alt:t.author.username,className:"w-16 h-16 rounded-full"})}),Object(f.jsxs)("div",{className:"flex flex-col",children:[Object(f.jsxs)("div",{className:"flex items-center",children:[Object(f.jsx)("h4",{className:"text-xl ml-6",children:t.author.username}),Object(f.jsxs)("h4",{className:"text-xl ml-6",children:["#",(s=t.createdAt,new Date(s).toISOString().split("T")[0])]}),a&&r===t.author.username&&Object(f.jsx)("span",{className:"absolute right-4 text-xl",children:Object(f.jsx)("i",{className:"fas fa-trash cursor-pointer text-red-500","data-id":t.id,onClick:function(t){return e.handleDelete(t)}})})]}),Object(f.jsx)("p",{className:"ml-6 my-4",children:t.body})]})]},t.createdAt);var s})):Object(f.jsx)("h2",{className:"text-xl text-red-400",children:"No comments yet!"})}):Object(f.jsx)(I,{})},F=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).handleChange=function(e){var t=e.target,r=t.name,s=t.value;a.setState(Object(w.a)({},r,s))},a.handleSubmit=function(e){e.preventDefault();var t=a.props.slug,r=a.state.inputText;r&&fetch(b+"/"+t+"/comments",{method:"POST",body:JSON.stringify({comment:{body:r}}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.app_user}}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(e){console.log(e),a.setState({inputText:"",comments:""},a.getComments)})).catch((function(e){return console.log(e)}))},a.handleDelete=function(e){var t=e.target.dataset.id;console.log(typeof t);var r=a.props.slug;fetch(b+"/"+r+"/comments/"+t,{method:"DELETE",headers:{Authorization:"Token "+localStorage.app_user}}).then((function(e){if(!e.ok)return e.json().then((function(e){var t=e.errors;return Promise.reject(t)}));a.setState({comments:""},a.getComments)})).catch((function(e){return console.log(e)}))},a.getComments=function(){var e=a.props.slug;fetch(b+"/"+e+"/comments").then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(e){var t=e.comments;console.log(t),a.setState({comments:t})})).catch((function(e){return console.log(e)}))},a.state={inputText:"",comments:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.getComments()}},{key:"render",value:function(){var e,t,r=this.state,a=r.inputText,s=r.comments,n=null===(e=this.props)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username;return Object(f.jsxs)(f.Fragment,{children:[n&&Object(f.jsx)("div",{className:"",children:Object(f.jsxs)("form",{className:"my-6 flex flex-col w-1/3",onSubmit:this.handleSubmit,children:[Object(f.jsx)("textarea",{className:"w-full border-2 border-gray-400 rounded-md p-3 outline-none focus:border-blue-500",rows:"3",placeholder:"Enter Comments",value:a,onChange:this.handleChange,name:"inputText"}),Object(f.jsx)("input",{type:"submit",value:"Add Comment",className:"px-2 py-1 shadow-md btn-green self-end text-white text-xs rounded-md cursor-pointer hover:bg-blue-400 mt-5"})]})}),Object(f.jsx)("div",{className:"my-8",children:Object(f.jsx)(U,{loggedInUser:n,comments:s,isLoggedIn:this.props.isLoggedIn,handleDelete:this.handleDelete})})]})}}]),r}(s.a.Component),z=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).getArticle=function(){var e=a.props.match.params.slug;fetch(b+"/".concat(e)).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){a.setState({article:e.article})})).catch((function(e){a.setState({error:"Not able to fetch Articles"})}))},a.getDate=function(e){return new Date(e).toISOString().split("T")[0]},a.handleEdit=function(){var e=a.state.article.slug;console.log(a.props,"Article props from edit"),a.props.history.push({pathname:"/articles/edit/".concat(e),article:a.state.article})},a.handleDelete=function(){var e=a.props.user;fetch(b+"/"+a.props.match.params.slug,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.app_user}}).then((function(t){if(!t.ok)return t.json().then((function(e){var t=e.errors;return Promise.reject(t)}));a.props.history.push("/profiles/".concat(e.username))})).catch((function(e){return console.log(e)}))},a.state={article:"",error:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.getArticle()}},{key:"render",value:function(){var e,t,r,a,s=this.state,n=s.error,c=s.article,i=null===(e=this.props)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username;console.log(this.props,"from Articles");var l=null===(r=this.props)||void 0===r?void 0:r.isLoggedIn,d=null===(a=this.props)||void 0===a?void 0:a.user;if(n)return Object(f.jsx)("h2",{className:"text-red-500 text-center text-xl mt-8",children:n});if(!c)return Object(f.jsx)(I,{});var u=c.tagList;return Object(f.jsxs)("main",{children:[Object(f.jsxs)("section",{className:"px-20 bg-green-700 text-white py-12",children:[Object(f.jsx)("h2",{className:"mt-2 mb-3 text-4xl",children:c.title}),Object(f.jsx)("p",{className:"",children:c.description}),Object(f.jsxs)("div",{className:"flex py-6 items-center",children:[Object(f.jsx)(h.b,{to:"/profiles/".concat(c.author.username),children:Object(f.jsx)("img",{src:c.author.image,alt:c.author.username,className:"w-16 h-16 object-cover rounded-full"})}),Object(f.jsx)("span",{className:"mx-3",children:c.author.username}),Object(f.jsx)("span",{className:"mx-3",children:this.getDate(c.createdAt)})]}),Object(f.jsx)("div",{className:"flex",children:u.map((function(e){return Object(f.jsx)("span",{className:"mr-3 bg-blue-500 p-1 px-2 text-xs rounded-md",children:e},e)}))}),l&&d.username===c.author.username&&Object(f.jsxs)("div",{className:"float-right",children:[Object(f.jsxs)("span",{className:"btn bg-gray-300 text-gray-600 rounded-md mx-3 cursor-pointer",onClick:this.handleEdit,children:[Object(f.jsx)("i",{className:"far fa-edit mr-2"})," Edit"]}),Object(f.jsxs)("span",{className:"bg-red-700 btn text-white rounded-md mx-3 cursor-pointer",onClick:this.handleDelete,children:[Object(f.jsx)("i",{className:"far fa-trash-alt mr-2"}),"Delete"]})]})]}),Object(f.jsx)("section",{className:"px-20 py-12",children:Object(f.jsx)("p",{className:"text-lg text-gray-700 bg-yellow-100 px-5 py-5 border shadow-xl",children:c.body})}),Object(f.jsxs)("section",{className:"px-20 py-12",children:[Object(f.jsx)(F,Object(o.a)(Object(o.a)({},this.props),{},{slug:c.slug})),!i&&Object(f.jsx)("div",{className:"flex justify-center mt-10 mb-5",children:Object(f.jsxs)("h3",{className:"text-xl text-gray-600",children:["Please",Object(f.jsx)(h.b,{to:"/login",className:"text-green-700 mx-1",children:"Login"}),"to Add Comments on the Article"]})})]})]})}}]),r}(s.a.Component),B=Object(j.f)(z),_=r(38),M=r.n(_),J=r(42),G=(r(113),function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(i.a)(this,r);for(var a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))).state={title:"",description:"",tags:"",body:"",error:""},e.handleChange=function(t){var r=t.target,a=r.name,s=r.value;e.setState(Object(w.a)({},a,s))},e.handleSubmit=function(t){var r=e.state,a=r.title,s=r.description,n=r.tags,c=r.body;n=n.split(",").map((function(e){return e.trim()}));var o=localStorage.app_user;t.preventDefault(),a&&s&&n&&c?fetch(b,{method:"POST",headers:{"Content-type":"application/json",authorization:"Bearer ".concat(o)},body:JSON.stringify({article:{title:a,description:s,tagList:n,body:c}})}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(t){e.props.history.push("/articles/".concat(t.article.slug))})).catch((function(t){e.setState({title:"",description:"",body:"",tags:"",error:""})})):e.setState({title:"",description:"",body:"",tags:"",error:"Enter all fields"})},e.handleEditorChange=function(t){t.html;var r=t.text;e.setState({body:r})},e.clearEditor=function(e){e.html,e.text;return""},e}return Object(l.a)(r,[{key:"render",value:function(){var e=this,t=new M.a;return Object(f.jsx)("main",{children:Object(f.jsx)("section",{children:Object(f.jsxs)("form",{className:"w-2/4 mx-auto mt-10",onSubmit:this.handleSubmit,children:[Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"text",placeholder:"Enter Title",value:this.state.title,name:"title",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"text",placeholder:"Enter Description",value:this.state.description,name:"description",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)("input",{className:"block w-full my-3 py-2 px-3 border border-gray-400 rounded-md",type:"text",placeholder:"Enter Tags",value:this.state.tags,name:"tags",onChange:function(t){return e.handleChange(t)}}),Object(f.jsx)(J.a,{style:{height:"500px"},renderHTML:function(e){return t.render(e)},onChange:this.handleEditorChange,onSubmit:this.clearEditor}),Object(f.jsx)("input",{type:"submit",value:"Publish Article",className:"block float-right btn bg-green-500 text-white font-bold cursor-pointer mt-10"})]})})})}}]),r}(s.a.Component)),V=Object(j.f)(G),H=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).handleChange=function(e){var t,r=e.target,s=r.name,n=r.value,c=a.state.errors;S(c,s,n),a.setState((t={},Object(w.a)(t,s,n),Object(w.a)(t,"errors",c),t))},a.handleSubmit=function(e){var t=a.state,r=t.username,s=t.image,n=t.password,c=t.email,o=t.bio,i=t.errors;e.preventDefault(),r&&s&&n&&c&&o&&fetch(p,{method:"PUT",body:JSON.stringify({user:{username:r,email:c,password:n,bio:o,image:s}}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.app_user}}).then((function(e){return e.ok?e.json():e.json().then((function(e){for(var t in e.errors)i[t]="".concat(t," ").concat(e.errors[t]);return Promise.reject({errors:i})}))})).then((function(e){a.props.history.push("/profiles/".concat(e.user.username))})).catch((function(e){return a.setState({errors:i})}))},a.state={image:e.user.image,username:e.user.username,email:e.user.email,password:"",bio:e.user.bio,errors:{username:"",email:"",password:""}},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this.state.errors,t=e.username,r=e.email,a=e.password;return Object(f.jsx)("main",{children:Object(f.jsx)("section",{className:"py-20",children:Object(f.jsxs)("form",{className:"w-1/2 mx-auto p-8 border border-gray-400 rounded-md",onSubmit:this.handleSubmit,children:[Object(f.jsx)("legend",{className:"text-center text-3xl my-2 font-bold",children:"Settings"}),Object(f.jsxs)("fieldset",{className:"flex flex-col",children:[Object(f.jsx)("input",{type:"text",placeholder:"Image Url",value:this.state.image,onChange:this.handleChange,name:"image",className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("span",{className:"my-1 text-red-500",children:t}),Object(f.jsx)("input",{type:"email",name:"email",value:this.state.email,onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("span",{className:"my-1 text-red-500",children:r}),Object(f.jsx)("input",{type:"password",name:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("span",{className:"my-1 text-red-500",children:a}),Object(f.jsx)("textarea",{value:this.state.bio,rows:"6",name:"bio",placeholder:"Enter your Bio",onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("input",{type:"submit",value:"Update",className:"btn btn-green"})]})]})})})}}]),r}(s.a.Component),q=Object(j.f)(H),Z=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).getUserInfo=function(){var e=a.props.match.params.id;fetch(x+e,{method:"GET",headers:{Authorization:"Bearer "+localStorage.app_user}}).then((function(e){return e.ok?e.json():e.json().then((function(e){e.errors;return Promise.reject()}))})).then((function(e){var t=e.profile;console.log({profile:t}),a.setState({user:t,following:t.following},a.getFeedArticles)})).catch((function(e){return console.log(e)}))},a.handleClick=function(e){var t=e.target.dataset.id;a.setState({activePageIndex:t},a.getFeedArticles)},a.updateCurrentPageIndex=function(e){a.setState({activePageIndex:e},a.getFeedArticles)},a.getFeedArticles=function(){var e=a.state.user.username,t=10*(a.state.activePageIndex-1),r=localStorage.app_user;fetch("".concat(b,"?").concat(a.state.feedSelected,"=").concat(e,"&limit=").concat(a.state.articlesPerPage,"&offset=").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(r),"Content-type":"application/json"}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){a.setState({articles:e.articles,articlesCount:e.articlesCount})})).catch((function(e){a.setState({error:"Not able to fetch Articles"})}))},a.handleFollow=function(){a.getUserInfo();var e=a.state.user.username,t=a.state.following;fetch(x+"/"+e+"/follow",{method:t?"DELETE":"POST",headers:{Authorization:"Bearer "+localStorage.app_user}}).then((function(e){return e.ok?e.json():e.json().then((function(e){e.errors;return Promise.reject()}))})).then((function(e){var t=e.profile;console.log(t),a.setState({following:t.following})})).catch((function(e){return console.log(e)}))},a.handleFavorite=function(e){var t=e.target.dataset,r=t.id,s=t.slug,n="false"===r?"POST":"DELETE";console.log(n),console.log(r,s),fetch(b+"/"+s+"/favorite",{method:n,headers:{Authorization:"Token "+localStorage.app_user}}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(e){a.getFeedArticles()})).catch((function(e){return console.log(e)}))},a.state={user:"",articles:null,articlesCount:null,articlesPerPage:10,activePageIndex:1,feedSelected:"author",following:"",error:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.getUserInfo()}},{key:"componentDidUpdate",value:function(){var e=this.state.user,t=this.props.match.params.id;e.username!==t&&this.getUserInfo()}},{key:"render",value:function(){var e,t,r=this;if(!this.state.user)return Object(f.jsx)(I,{});var a=this.state.user,s=a.username,n=a.image,c=a.bio,o=null===(e=this.props)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username,i=this.state,l=i.articles,d=i.error,u=i.articlesCount,j=i.activePageIndex,m=i.articlesPerPage,b=i.feedSelected,p=i.following;return Object(f.jsx)("main",{children:Object(f.jsxs)("section",{children:[Object(f.jsxs)("div",{className:"bg-indigo-200 text-white py-16 text-center",children:[Object(f.jsx)("img",{src:n,alt:s,className:"w-40 h-40 rounded-full mx-auto"}),Object(f.jsx)("h2",{className:"text-4xl my-4 text-gray-700",children:s}),Object(f.jsx)("h3",{className:"text-2xl text-yellow-500 mb-5",children:c}),Object(f.jsxs)("div",{className:"float-right mr-10 ",children:[o!==s&&Object(f.jsxs)("button",{className:"bg-blue-300 text-gray-700 btn rounded-full hover:bg-blue-400 transform transition duration-500 hover:scale-105",onClick:this.handleFollow,children:[Object(f.jsx)("i",{className:"fas fa-plus mr-2"}),p?"unfollow":"follow"]}),o===s&&Object(f.jsxs)(h.b,{to:"/settings",className:"btn bg-gray-200 text-gray-600 hover:bg-yellow-200",children:[Object(f.jsx)("i",{className:"fas fa-user-edit mr-2"}),"Edit Profile"]})]})]}),Object(f.jsxs)("article",{className:"px-40",children:[Object(f.jsxs)("div",{className:"py-6",children:[Object(f.jsxs)("span",{className:"author"===b?"cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500":"cursor-pointer text-xl",onClick:function(){return r.setState({feedSelected:"author",activePageIndex:1},r.getFeedArticles)},children:[Object(f.jsx)("i",{className:"fas fa-newspaper mr-2"}),"Articles written"]}),Object(f.jsx)("span",{className:"mx-4",children:"/"}),Object(f.jsxs)("span",{className:"favorited"===b?"cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500":"cursor-pointer text-xl",onClick:function(){return r.setState({feedSelected:"favorited",activePageIndex:1},r.getFeedArticles)},children:[Object(f.jsx)("i",{className:"fas fa-newspaper mr-2"}),"Favorited"]})]}),Object(f.jsx)("div",{className:"",children:Object(f.jsx)(T,{articles:l,error:d,isLoggedIn:this.props.isLoggedIn,handleFavorite:this.handleFavorite})})]}),Object(f.jsx)("div",{className:"text-center py-8 flex justify-center",children:Object(f.jsx)(L,{articlesCount:u,articlesPerPage:m,activePageIndex:j,handleClick:this.handleClick,updateCurrentPageIndex:this.updateCurrentPageIndex})})]})})}}]),r}(s.a.Component),R=Object(j.f)(Z);var W=function(){return Object(f.jsx)("div",{className:"flex justify-center p-5 h-screen items-center",children:Object(f.jsxs)("div",{className:"lds-grid",children:[Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{})]})})},$=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this)).getArticle=function(){fetch(b+"/".concat(a.props.match.params.slug)).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){var t=e.article,r=t.title,s=t.description,n=t.tagList,c=t.body;a.setState({article:t,title:r,body:c,description:s,tags:n.join(",")})})).catch((function(e){console.log(e)}))},a.handleChange=function(e){var t=e.target,r=t.name,s=t.value;a.setState(Object(w.a)({},r,s))},a.handleSubmit=function(e){var t=a.state,r=t.title,s=t.description,n=t.body,c=t.tags,o="Bearer "+localStorage.app_user;e.preventDefault(),r&&s&&n&&c?fetch(b+"/"+a.props.match.params.slug,{method:"PUT",body:JSON.stringify({article:{title:r,description:s,body:n,tagList:c.split(",").map((function(e){return e.trim()}))}}),headers:{"Content-Type":"application/json",Authorization:o}}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(e){a.props.history.push("/articles/".concat(a.props.match.params.slug))})).catch((function(e){console.log(e)})):a.setState({error:"Enter all fields"})},a.state={article:"",title:"",description:"",body:"",tags:"",error:""},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.getArticle()}},{key:"render",value:function(){var e=this.state,t=e.title,r=e.description,a=e.body,s=e.tags,n=e.error;return e.article?Object(f.jsx)("main",{children:Object(f.jsx)("section",{className:"pt-20",children:Object(f.jsxs)("form",{className:"w-1/2 mx-auto p-8 border border-gray-400 rounded-md",onSubmit:this.handleSubmit,children:[Object(f.jsx)("legend",{className:"text-3xl text-center font-bold my-3 text-indigo-900",children:"Edit Article"}),Object(f.jsxs)("fieldset",{className:"flex flex-col",children:[Object(f.jsx)("span",{className:"text-red-500 my-1",children:n}),Object(f.jsx)("input",{type:"text",value:t,placeholder:"Title",name:"title",onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("input",{type:"text",value:r,name:"description",placeholder:"Description",onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("textarea",{rows:"6",value:a,name:"body",placeholder:"Articles's Body",onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("input",{type:"text",value:s,name:"tags",placeholder:"Tag List(comma seperated)",onChange:this.handleChange,className:"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500"}),Object(f.jsx)("input",{type:"submit",value:"Update Article",className:"btn w-2/6 self-end bg-blue-500 hover:bg-blue-400 text-white "})]})]})})}):Object(f.jsx)(I,{})}}]),r}(s.a.Component),K=Object(j.f)($);var Q=function(e){return Object(f.jsx)("h2",{className:"text-red-700 text-xl text-center py-8 font-bold",children:"404 Page Not Found"})};function X(e){return Object(f.jsxs)(j.c,{children:[Object(f.jsx)(j.a,{path:"/",exact:!0,children:Object(f.jsx)(N,{})}),Object(f.jsx)(j.a,{path:"/articles",exact:!0,children:Object(f.jsx)(D,Object(o.a)({},e))}),Object(f.jsx)(j.a,{path:"/articles/edit/:slug",children:Object(f.jsx)(K,{})}),Object(f.jsx)(j.a,{path:"/articles/:slug",children:Object(f.jsx)(B,Object(o.a)({},e))}),Object(f.jsx)(j.a,{path:"/new-article",exact:!0,children:Object(f.jsx)(V,{})}),Object(f.jsx)(j.a,{path:"/settings",exact:!0,children:Object(f.jsx)(q,{user:e.user,handleUser:e.updateUser})}),Object(f.jsx)(j.a,{path:"/profiles/:id",exact:!0,children:Object(f.jsx)(R,{user:e.user})}),Object(f.jsx)(j.a,{path:"*",children:Object(f.jsx)(Q,{})})]})}function Y(e){return Object(f.jsxs)(j.c,{children:[Object(f.jsx)(j.a,{path:"/",exact:!0,children:Object(f.jsx)(N,{})}),Object(f.jsx)(j.a,{path:"/register",exact:!0,children:Object(f.jsx)(k,{updateUser:e.updateUser})}),Object(f.jsx)(j.a,{path:"/login",exact:!0,children:Object(f.jsx)(A,{updateUser:e.updateUser})}),Object(f.jsx)(j.a,{path:"/articles",exact:!0,children:Object(f.jsx)(D,Object(o.a)({},e))}),Object(f.jsx)(j.a,{path:"/articles/:slug",children:Object(f.jsx)(B,Object(o.a)({},e))}),Object(f.jsx)(j.a,{path:"/profiles/:id",exact:!0,children:Object(f.jsx)(R,{user:e.user})}),Object(f.jsx)(j.a,{path:"*",children:Object(f.jsx)(Q,{})})]})}var ee=function(e){Object(d.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(i.a)(this,r);for(var a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))).state={isLoggedIn:!1,user:null,isVerifying:!0},e.updateUser=function(t){e.setState({isLoggedIn:!0,user:t,isVerifying:!1}),localStorage.setItem(g,t.token)},e.handleLogout=function(){e.setState({isLoggedIn:!1,user:null})},e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.app_user;t?fetch(p,{method:"GET",headers:{authorization:"Token ".concat(t)}}).then((function(e){return e.ok?e.json():e.json().then((function(e){var t=e.errors;return Promise.reject(t)}))})).then((function(t){var r=t.user;return e.updateUser(r)})).catch((function(e){return console.log(e)})):this.setState({isVerifying:!1})}},{key:"render",value:function(){return this.state.isVerifying?(console.log("Is Verifying"),Object(f.jsx)(W,{})):Object(f.jsxs)(h.a,{children:[Object(f.jsx)(y,Object(o.a)(Object(o.a)({},this.state),{},{handleLogout:this.handleLogout})),this.state.isLoggedIn?Object(f.jsx)(X,Object(o.a)(Object(o.a)({},this.state),{},{handleUser:this.updateUser})):Object(f.jsx)(Y,{updateUser:this.updateUser})]})}}]),r}(s.a.Component);c.a.render(Object(f.jsx)(h.a,{children:Object(f.jsx)(ee,{})}),document.getElementById("root"))},20:function(e,t,r){},47:function(e,t,r){}},[[114,1,2]]]);
//# sourceMappingURL=main.43d6fef2.chunk.js.map